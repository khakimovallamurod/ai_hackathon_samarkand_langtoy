<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Nybble Mushuk Boshqaruvi</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: #0c1425 url(https://www.transparenttextures.com/patterns/stardust.png) repeat top center;
            animation: move-stars 150s linear infinite;
        }
        @keyframes move-stars {
            from {background-position-y: 0px;}
            to   {background-position-y: -2000px;}
        }

        @keyframes pulse-neon-text {
            0%, 100% { text-shadow: 0 0 7px #0ea5e9, 0 0 12px #0ea5e9, 0 0 25px #0ea5e9; color: #f0f9ff; }
            50% { text-shadow: 0 0 10px #0ea5e9, 0 0 25px #0ea5e9, 0 0 50px #2563eb; color: #fff; }
        }
        @keyframes scanline-anim { 0% { transform: translateY(-10%); } 100% { transform: translateY(105%); } }
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes blink-caret { from, to { border-color: transparent; } 50% { border-color: #0ea5e9; } }

        .neon-text { animation: pulse-neon-text 4s ease-in-out infinite; }
        .animate-fade-in-up { animation: fade-in-up 1s ease-out forwards; }
        .typing-effect { border-right: .15em solid #0ea5e9; white-space: nowrap; overflow: hidden; animation: blink-caret .75s step-end infinite; }
        
        .hud-corners { position: relative; padding: 8px; border: 1px solid rgba(14, 165, 233, 0.15); }
        .hud-corners::before, .hud-corners::after, .hud-corners > .bottom-corners::before, .hud-corners > .bottom-corners::after { content: ''; position: absolute; width: 32px; height: 32px; border-style: solid; border-color: #0ea5e9; opacity: 0; animation: fade-in-up 0.5s ease-out 0.5s forwards; }
        .hud-corners::before { top: 0; left: 0; border-width: 3px 0 0 3px; }
        .hud-corners::after { top: 0; right: 0; border-width: 3px 3px 0 0; }
        .hud-corners > .bottom-corners::before { bottom: 0; left: 0; border-width: 0 0 3px 3px; }
        .hud-corners > .bottom-corners::after { bottom: 0; right: 0; border-width: 0 0 3px 3px; }
        .scanline { position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(to bottom, rgba(14, 165, 233, 0), rgba(14, 165, 233, 0.7), rgba(14, 165, 233, 0)); animation: scanline-anim 6s linear infinite; box-shadow: 0 0 10px #0ea5e9; border-radius: 50%; }
        
        /* Button press animation */
        .btn-press { transform: scale(0.95); }
        
        /* Connection status indicator */
        .connection-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .connection-status::before {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        .connection-status.connected {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }
        .connection-status.connected::before {
            background: #4ade80;
        }
        .connection-status.disconnected {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
        }
        .connection-status.disconnected::before {
            background: #f87171;
        }
    </style>
</head>
<body class="bg-[#0c1425] text-gray-200 font-inter">

    <div class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6">
        
        <div class="w-full max-w-7xl text-center mb-6 animate-fade-in-up" style="animation-delay: 0.2s;">
            <h1 class="text-3xl sm:text-4xl font-black neon-text flex items-center justify-center gap-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
                Child Safety Monitoring
            </h1>
            <p id="subtitle" class="text-gray-400 mt-2 text-sm sm:text-base mx-auto"></p>
        </div>

        <div class="w-full max-w-7xl p-4 sm:p-6 rounded-2xl bg-slate-900/50 backdrop-blur-sm">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">

                <div class="hud-corners rounded-lg overflow-hidden shadow-2xl shadow-sky-900/50 animate-fade-in-up" style="animation-delay: 0.4s;">
                    <div class="relative">
                        <img src="{{ url_for('video_feed') }}" class="w-full h-auto bg-black rounded-md" alt="Video oqimi yuklanmoqda...">
                        <div class="scanline"></div>
                        <div class="bottom-corners"></div>
                    </div>
                </div>

                <div class="animate-fade-in-up" style="animation-delay: 0.6s;">
                    <div class="grid grid-cols-1 gap-4 max-w-[250px] mx-auto">
                        
                        <button onclick="sendCommand('stand_up')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-sky-500/50 text-sky-300 hover:bg-sky-500/20 hover:border-sky-500 hover:text-white hover:scale-105 active:scale-100">
                            Stand Up
                        </button>
                        <button  onclick="sendCommand('sit_down')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-sky-500/50 text-sky-300 hover:bg-sky-500/20 hover:border-sky-500 hover:text-white hover:scale-105 active:scale-100">
                            Sit Down
                        </button>
                        <button onclick="sendCommand('push_up')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-sky-500/50 text-sky-300 hover:bg-sky-500/20 hover:border-sky-500 hover:text-white hover:scale-105 active:scale-100">
                            Push Up
                        </button>
                        <button onclick="sendCommand('tik_turish')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-sky-500/50 text-sky-300 hover:bg-sky-500/20 hover:border-sky-500 hover:text-white hover:scale-105 active:scale-100">
                            Tik Turish
                        </button>
                        <button onclick="sendCommand('walk')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-sky-500/50 text-sky-300 hover:bg-sky-500/20 hover:border-sky-500 hover:text-white hover:scale-105 active:scale-100">
                            Walk
                        </button>
                        <button onclick="sendCommand('fire_alert')" class="robot-btn p-4 rounded-lg text-center transition-all duration-300 font-semibold border-2 border-red-500/50 text-red-400 hover:bg-red-500/20 hover:border-red-500 hover:text-white hover:scale-105 active:scale-100">
                            Warning
                        </button>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Connection status indicator -->
    <div id="connectionStatus" class="connection-status disconnected">
        Disconnected
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Typing effect for subtitle
            const textToType = "Robot mushuk uchun real vaqtdagi buyruqlar paneli";
            const subtitleElement = document.getElementById('subtitle');
            let charIndex = 0;

            function type() {
                if (charIndex < textToType.length) {
                    subtitleElement.textContent += textToType.charAt(charIndex);
                    subtitleElement.style.display = 'inline-block';
                    subtitleElement.classList.add('typing-effect');
                    charIndex++;
                    setTimeout(type, 60);
                } else {
                    subtitleElement.style.borderRight = 'none';
                    subtitleElement.classList.remove('typing-effect');
                }
            }
            setTimeout(type, 1000); 
        });
        function sendCommand(command) {
            fetch('/send_command/' + command, { method: 'POST' })
                .then(response => {
                    console.log('"' + command + '" buyrug`i yuborildi.');
                })
                .catch(error => {
                    console.error('Buyruq yuborishda xato:', error);
                });
        }
    </script>
</body>
</html>